<h1>管理者用レビュー一覧</h1>

<%= link_to "トップに戻る", admin_root_path %>

  <!-- Ransack 検索用 -->
  <%= search_form_for @q, url: admin_reviews_path, method: :get do |f| %>
    <div>
      <%= f.label :user_display_name_cont, "投稿者検索" %>
      <%= f.search_field :user_display_name_cont %>
    </div>

    <div>
      <%= f.label :product_name_cont, "製品名検索" %>
      <%= f.search_field :product_name_cont %>
    </div>

    <div>
      <%= f.label :rating_eq, "✩" %>
      <!-- ["すべて", ""] で空欄を選択できるようにしてる -->
      <%= f.select :rating_eq, options_for_select([["すべて", ""], 5, 4, 3, 2, 1]) %>
    </div>

    <div>
      <%= f.submit "検索実行" %>
    </div>
  <% end %>

<!-- レビュー 一覧表示 -->
<% @reviews.each do |review| %>
  <!-- タイトル -->
  <p>タイトル: <%= review.title %></p>

  <p>✩: <%= review.rating %></p>

  <p>製品: <%= review.product_name %></p>

  <p>本文: <%= review.post %></p>

  <!-- 製品画像 -->
  <% if review.reviews_image.attached? %>
    <p>製品画像 <%= image_tag review.reviews_image.variant(resize: "70x70").processed %></p>
  <% else %>
    <p>画像がありません… <%= image_tag "no_image_review.jpg", size: "70x70" %></p>
  <% end %> 

  <!-- 投稿者名 -->
  <p>投稿者: <%= review.user.display_name %></p>

  <!-- 投稿者メールアドレス -->
  <p>メールアドレス: <%= review.user.email %></p>

  <!-- レビュー削除ボタン -->
  <%= link_to "このレビューを削除する", review_path(review.id), method: :delete , data: { confirm: "本当に削除しますか？" } %>
<% end %>
